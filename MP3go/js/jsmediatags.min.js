var $jscomp=$jscomp||{};$jscomp.scope={},$jscomp.ASSUME_ES5=!1,$jscomp.ASSUME_NO_NATIVE_MAP=!1,$jscomp.ASSUME_NO_NATIVE_SET=!1,$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){e!=Array.prototype&&e!=Object.prototype&&(e[t]=n.value)},$jscomp.getGlobal=function(e){return("undefined"==typeof window||window!==e)&&"undefined"!=typeof global&&null!=global?global:e},$jscomp.global=$jscomp.getGlobal(this),$jscomp.polyfill=function(e,t,n,r){if(t){for(n=$jscomp.global,e=e.split("."),r=0;r<e.length-1;r++){var o=e[r];o in n||(n[o]={}),n=n[o]}(t=t(r=n[e=e[e.length-1]]))!=r&&null!=t&&$jscomp.defineProperty(n,e,{configurable:!0,writable:!0,value:t})}},$jscomp.polyfill("Object.setPrototypeOf",function(e){return e||("object"!=typeof"".__proto__?null:function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e})},"es6","es5"),$jscomp.objectCreate=$jscomp.ASSUME_ES5||"function"==typeof Object.create?Object.create:function(e){function C(){}return C.prototype=e,new C},$jscomp.construct="undefined"!=typeof Reflect&&Reflect.construct||function(e,t,n){return n=$jscomp.objectCreate((n=void 0===n?e:n).prototype||Object.prototype),Function.prototype.apply.call(e,n,t)||n},$jscomp.polyfill("Reflect.construct",function(e){return e||$jscomp.construct},"es6","es3"),function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).jsmediatags=e()}(function(){return function d(r,o,i){function u(t,e){if(!o[t]){if(!r[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(a)return a(t,!0);throw(e=Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",e}e=o[t]={exports:{}},r[t][0].call(e.exports,function(e){return u(r[t][1][e]||e)},e,e.exports,d,r,o,i)}return o[t].exports}for(var a="function"==typeof require&&require,e=0;e<i.length;e++)u(i[e]);return u}({1:[function(e,t,n){},{}],2:[function(e,t,n){t.exports=XMLHttpRequest},{}],3:[function(r,o,i){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function e(t,n){return(e=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(t,n)}function b(o){var i=function l(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,r=t(o);return r=!(r=i?(e=t(this).constructor,Reflect.construct(r,arguments,e)):r.apply(this,arguments))||"object"!==n(r)&&"function"!=typeof r?h(this):r}}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function t(e){return(t=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}function a(e){var t;if(this instanceof a)return m(h(t=s.call(this)),"_array",void 0),m(h(t),"_size",void 0),t._array=e,t._size=e.length,t._isInitialized=!0,t;throw new TypeError("Cannot call a class as a function")}var s;(function p(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&e(t,n)})(a,r("./MediaFileReader")),s=b(a),function v(e,t,n){t&&u(e.prototype,t),n&&u(e,n)}(a,[{key:"init",value:function(e){setTimeout(e.onSuccess,0)}},{key:"loadRange",value:function(e,t){setTimeout(t.onSuccess,0)}},{key:"getByteAt",value:function(e){if(e>=this._array.length)throw Error("Offset "+e+" hasn't been loaded yet.");return this._array[e]}}],[{key:"canReadFile",value:function(e){return Array.isArray(e)||"function"==typeof Buffer&&Buffer.isBuffer(e)}}]),r=a,o.exports=r},{"./MediaFileReader":11}],4:[function(r,o,i){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function e(t,n){return(e=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(t,n)}function b(o){var i=function l(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,r=t(o);return r=!(r=i?(e=t(this).constructor,Reflect.construct(r,arguments,e)):r.apply(this,arguments))||"object"!==n(r)&&"function"!=typeof r?h(this):r}}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function t(e){return(t=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}var a,s=r("./ChunkedFileData");function c(e){var t;if(this instanceof c)return m(h(t=a.call(this)),"_blob",void 0),m(h(t),"_fileData",void 0),t._blob=e,t._fileData=new s,t;throw new TypeError("Cannot call a class as a function")}(function p(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&e(t,n)})(c,r("./MediaFileReader")),a=b(c),function v(e,t,n){t&&u(e.prototype,t),n&&u(e,n)}(c,[{key:"_init",value:function(e){this._size=this._blob.size,setTimeout(e.onSuccess,1)}},{key:"loadRange",value:function(t,n){var r=this,e=(this._blob.slice||this._blob.mozSlice||this._blob.webkitSlice).call(this._blob,t[0],t[1]+1),o=new FileReader;o.onloadend=function(e){e=new Uint8Array(o.result),r._fileData.addData(t[0],e),n.onSuccess()},o.onerror=o.onabort=function(e){n.onError&&n.onError({type:"blob",info:o.error})},o.readAsArrayBuffer(e)}},{key:"getByteAt",value:function(e){return this._fileData.getByteAt(e)}}],[{key:"canReadFile",value:function(e){return"undefined"!=typeof Blob&&e instanceof Blob||"undefined"!=typeof File&&e instanceof File}}]),r=c,o.exports=r},{"./ChunkedFileData":5,"./MediaFileReader":11}],5:[function(e,t,r){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(){if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");"_fileData"in this?Object.defineProperty(this,"_fileData",{value:void 0,enumerable:!0,configurable:!0,writable:!0}):this._fileData=void 0,this._fileData=[]}(function u(e,t,r){t&&n(e.prototype,t),r&&n(e,r)})(d,[{key:"addData",value:function(e,t){var n,r,o,i=e+t.length-1,a=this._getChunkRange(e,i);-1===a.startIx?this._fileData.splice(a.insertIx||0,0,{offset:e,data:t}):(n=this._fileData[a.startIx],i=i<(r=this._fileData[a.endIx]).offset+r.data.length-1,o={offset:Math.min(e,n.offset),data:t},e>n.offset&&(e=this._sliceData(n.data,0,e-n.offset),o.data=this._concatData(e,t)),i&&(e=this._sliceData(o.data,0,r.offset-o.offset),o.data=this._concatData(e,r.data)),this._fileData.splice(a.startIx,a.endIx-a.startIx+1,o))}},{key:"_concatData",value:function(e,t){var n;return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(e)?((n=new e.constructor(e.length+t.length)).set(e,0),n.set(t,e.length),n):e.concat(t)}},{key:"_sliceData",value:function(e,t,n){return e.slice?e.slice(t,n):e.subarray(t,n)}},{key:"_getChunkRange",value:function(e,t){for(var n,r,o=-1,i=-1,a=0,u=0;u<this._fileData.length&&(n=(r=this._fileData[u].offset)+this._fileData[u].data.length,!(t<r-1));a=++u)if(e<=n+1&&r-1<=t){o=u;break}if(-1===o)return{startIx:-1,endIx:-1,insertIx:a};for(u=o;u<this._fileData.length&&((r=this._fileData[u].offset)-1<=t&&(i=u),!(t<=(n=r+this._fileData[u].data.length)+1));u++);return{startIx:o,endIx:i=-1===i?o:i}}},{key:"hasDataRange",value:function(e,t){for(var n=0;n<this._fileData.length;n++){var r=this._fileData[n];if(t<r.offset)break;if(r.offset<=e&&t<r.offset+r.data.length)return!0}return!1}},{key:"getByteAt",value:function(e){for(var t,n=0;n<this._fileData.length;n++){var r=this._fileData[n].offset,o=r+this._fileData[n].data.length-1;if(r<=e&&e<=o){t=this._fileData[n];break}}if(t)return t.data[e-t.offset];throw Error("Offset "+e+" hasn't been loaded yet.")}}],[{key:"NOT_FOUND",get:function(){return-1}}]),t.exports=d},{}],6:[function(r,o,i){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function e(t,n){return(e=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(t,n)}function b(o){var i=function l(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,r=t(o);return r=!(r=i?(e=t(this).constructor,Reflect.construct(r,arguments,e)):r.apply(this,arguments))||"object"!==n(r)&&"function"!=typeof r?h(this):r}}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function t(e){return(t=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}var a,s=[4,132],c=[6,134],y="Other;32x32 pixels 'file icon' (PNG only);Other file icon;Cover (front);Cover (back);Leaflet page;Media (e.g. label side of CD);Lead artist/lead performer/soloist;Artist/performer;Conductor;Band/Orchestra;Composer;Lyricist/text writer;Recording Location;During recording;During performance;Movie/video screen capture;A bright coloured fish;Illustration;Band/artist logotype;Publisher/Studio logotype".split(";");function g(){if(!(this instanceof g))throw new TypeError("Cannot call a class as a function");for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return m(h(e=a.call.apply(a,[this].concat(t))),"_commentOffset",void 0),m(h(e),"_pictureOffset",void 0),e}(function p(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&e(t,n)})(g,r("./MediaTagReader")),a=b(g),function v(e,t,n){t&&u(e.prototype,t),n&&u(e,n)}(g,[{key:"_loadData",value:function(e,t){var n=this;e.loadRange([4,7],{onSuccess:function(){n._loadBlock(e,4,t)}})}},{key:"_loadBlock",value:function(e,t,n){var r,o=this,i=e.getByteAt(t),a=e.getInteger24At(t+1,!0);-1!==s.indexOf(i)?(r=t+4,e.loadRange([r,r+a],{onSuccess:function(){o._commentOffset=r,o._nextBlock(e,t,i,a,n)}})):-1!==c.indexOf(i)?(r=t+4,e.loadRange([r,r+a],{onSuccess:function(){o._pictureOffset=r,o._nextBlock(e,t,i,a,n)}})):o._nextBlock(e,t,i,a,n)}},{key:"_nextBlock",value:function(e,t,n,r,o){var i=this;127<n?i._commentOffset?o.onSuccess():o.onError({type:"loadData",info:"Comment block could not be found."}):e.loadRange([t+4+r,t+4+4+r],{onSuccess:function(){i._loadBlock(e,t+4+r,o)}})}},{key:"_parseData",value:function(e,t){var n=e.getLongAt(this._commentOffset,!1)+(this._commentOffset+4);t=e.getLongAt(n,!1),n+=4;for(var r,o,i,a,u,s,c=0;c<t;c++){var f=e.getLongAt(n,!1),l=e.getStringWithCharsetAt(n+4,f,"utf-8").toString(),d=l.indexOf("=");switch((l=[l.slice(0,d),l.slice(d+1)])[0].toUpperCase()){case"TITLE":r=l[1];break;case"ARTIST":o=l[1];break;case"ALBUM":i=l[1];break;case"TRACKNUMBER":a=l[1];break;case"GENRE":u=l[1]}n+=4+f}return this._pictureOffset&&(s=e.getLongAt(this._pictureOffset,!0),t=this._pictureOffset+4,n=e.getLongAt(t,!0),t=e.getStringAt(c=t+4,n),c=e.getLongAt(n=c+n,!0),n=e.getStringWithCharsetAt(f=n+4,c,"utf-8").toString(),f=e.getLongAt(c=f+c+16,!0),e=e.getBytesAt(c+4,f,!0),s={format:t,type:y[s],description:n,data:e}),{type:"FLAC",version:"1",tags:{title:r,artist:o,album:i,track:a,genre:u,picture:s}}}}],[{key:"getTagIdentifierByteRange",value:function(){return{offset:0,length:4}}},{key:"canReadTagFormat",value:function(e){return"fLaC"===String.fromCharCode.apply(String,e.slice(0,4))}}]),r=g,o.exports=r},{"./MediaTagReader":12}],7:[function(t,r,o){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function e(t,n){return(e=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(t,n)}function b(r){var o=function h(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=l(r);if(!(t=o?(e=l(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))||"object"!==n(t)&&"function"!=typeof t){if(void 0===this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");t=this}return t}}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(){if(this instanceof f)return i.apply(this,arguments);throw new TypeError("Cannot call a class as a function")}o=t("./MediaTagReader"),t("./MediaFileReader"),function p(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&e(t,n)}(f,o),i=b(f),function v(e,t,n){t&&u(e.prototype,t),n&&u(e,n)}(f,[{key:"_loadData",value:function(e,t){var n=e.getSize();e.loadRange([n-128,n-1],t)}},{key:"_parseData",value:function(e,t){var n,r=e.getSize()-128,o=e.getStringWithCharsetAt(3+r,30).toString(),i=e.getStringWithCharsetAt(33+r,30).toString(),a=e.getStringWithCharsetAt(63+r,30).toString(),u=e.getStringWithCharsetAt(93+r,4).toString(),s=e.getByteAt(97+r+28);return t=e.getByteAt(97+r+29),0==s&&0!=t?(n="1.1",s=e.getStringWithCharsetAt(97+r,28).toString()):(n="1.0",s=e.getStringWithCharsetAt(97+r,30).toString(),t=0),e={type:"ID3",version:n,tags:{title:o,artist:i,album:a,year:u,comment:s,genre:(e=e.getByteAt(97+r+30))<255?c[e]:""}},t&&(e.tags.track=t),e}}],[{key:"getTagIdentifierByteRange",value:function(){return{offset:-128,length:128}}},{key:"canReadTagFormat",value:function(e){return"TAG"===String.fromCharCode.apply(String,e.slice(0,3))}}]),t=f;var i,c="Blues;Classic Rock;Country;Dance;Disco;Funk;Grunge;Hip-Hop;Jazz;Metal;New Age;Oldies;Other;Pop;R&B;Rap;Reggae;Rock;Techno;Industrial;Alternative;Ska;Death Metal;Pranks;Soundtrack;Euro-Techno;Ambient;Trip-Hop;Vocal;Jazz+Funk;Fusion;Trance;Classical;Instrumental;Acid;House;Game;Sound Clip;Gospel;Noise;AlternRock;Bass;Soul;Punk;Space;Meditative;Instrumental Pop;Instrumental Rock;Ethnic;Gothic;Darkwave;Techno-Industrial;Electronic;Pop-Folk;Eurodance;Dream;Southern Rock;Comedy;Cult;Gangsta;Top 40;Christian Rap;Pop/Funk;Jungle;Native American;Cabaret;New Wave;Psychadelic;Rave;Showtunes;Trailer;Lo-Fi;Tribal;Acid Punk;Acid Jazz;Polka;Retro;Musical;Rock & Roll;Hard Rock;Folk;Folk-Rock;National Folk;Swing;Fast Fusion;Bebob;Latin;Revival;Celtic;Bluegrass;Avantgarde;Gothic Rock;Progressive Rock;Psychedelic Rock;Symphonic Rock;Slow Rock;Big Band;Chorus;Easy Listening;Acoustic;Humour;Speech;Chanson;Opera;Chamber Music;Sonata;Symphony;Booty Bass;Primus;Porn Groove;Satire;Slow Jam;Club;Tango;Samba;Folklore;Ballad;Power Ballad;Rhythmic Soul;Freestyle;Duet;Punk Rock;Drum Solo;Acapella;Euro-House;Dance Hall".split(";");r.exports=t},{"./MediaFileReader":11,"./MediaTagReader":12}],8:[function(t,r,o){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function v(e){switch(e){case 0:e="iso-8859-1";break;case 1:e="utf-16";break;case 2:e="utf-16be";break;case 3:e="utf-8";break;default:e="iso-8859-1"}return e}function p(e,t,n,r){var o=n.getStringWithCharsetAt(e+1,t-1,r);return e=n.getStringWithCharsetAt(e+1+o.bytesReadCount,t-1-o.bytesReadCount,r),{user_description:o.toString(),data:e.toString()}}t("./MediaFileReader");var s=t("./StringUtils"),i=t("./ArrayFileReader"),a={BUF:"Recommended buffer size",CNT:"Play counter",COM:"Comments",CRA:"Audio encryption",CRM:"Encrypted meta frame",ETC:"Event timing codes",EQU:"Equalization",GEO:"General encapsulated object",IPL:"Involved people list",LNK:"Linked information",MCI:"Music CD Identifier",MLL:"MPEG location lookup table",PIC:"Attached picture",POP:"Popularimeter",REV:"Reverb",RVA:"Relative volume adjustment",SLT:"Synchronized lyric/text",STC:"Synced tempo codes",TAL:"Album/Movie/Show title",TBP:"BPM (Beats Per Minute)",TCM:"Composer",TCO:"Content type",TCR:"Copyright message",TDA:"Date",TDY:"Playlist delay",TEN:"Encoded by",TFT:"File type",TIM:"Time",TKE:"Initial key",TLA:"Language(s)",TLE:"Length",TMT:"Media type",TOA:"Original artist(s)/performer(s)",TOF:"Original filename",TOL:"Original Lyricist(s)/text writer(s)",TOR:"Original release year",TOT:"Original album/Movie/Show title",TP1:"Lead artist(s)/Lead performer(s)/Soloist(s)/Performing group",TP2:"Band/Orchestra/Accompaniment",TP3:"Conductor/Performer refinement",TP4:"Interpreted, remixed, or otherwise modified by",TPA:"Part of a set",TPB:"Publisher",TRC:"ISRC (International Standard Recording Code)",TRD:"Recording dates",TRK:"Track number/Position in set",TSI:"Size",TSS:"Software/hardware and settings used for encoding",TT1:"Content group description",TT2:"Title/Songname/Content description",TT3:"Subtitle/Description refinement",TXT:"Lyricist/text writer",TXX:"User defined text information frame",TYE:"Year",UFI:"Unique file identifier",ULT:"Unsychronized lyric/text transcription",WAF:"Official audio file webpage",WAR:"Official artist/performer webpage",WAS:"Official audio source webpage",WCM:"Commercial information",WCP:"Copyright/Legal information",WPB:"Publishers official webpage",WXX:"User defined URL link frame",AENC:"Audio encryption",APIC:"Attached picture",ASPI:"Audio seek point index",CHAP:"Chapter",CTOC:"Table of contents",COMM:"Comments",COMR:"Commercial frame",ENCR:"Encryption method registration",EQU2:"Equalisation (2)",EQUA:"Equalization",ETCO:"Event timing codes",GEOB:"General encapsulated object",GRID:"Group identification registration",IPLS:"Involved people list",LINK:"Linked information",MCDI:"Music CD identifier",MLLT:"MPEG location lookup table",OWNE:"Ownership frame",PRIV:"Private frame",PCNT:"Play counter",POPM:"Popularimeter",POSS:"Position synchronisation frame",RBUF:"Recommended buffer size",RVA2:"Relative volume adjustment (2)",RVAD:"Relative volume adjustment",RVRB:"Reverb",SEEK:"Seek frame",SYLT:"Synchronized lyric/text",SYTC:"Synchronized tempo codes",TALB:"Album/Movie/Show title",TBPM:"BPM (beats per minute)",TCOM:"Composer",TCON:"Content type",TCOP:"Copyright message",TDAT:"Date",TDLY:"Playlist delay",TDRC:"Recording time",TDRL:"Release time",TDTG:"Tagging time",TENC:"Encoded by",TEXT:"Lyricist/Text writer",TFLT:"File type",TIME:"Time",TIPL:"Involved people list",TIT1:"Content group description",TIT2:"Title/songname/content description",TIT3:"Subtitle/Description refinement",TKEY:"Initial key",TLAN:"Language(s)",TLEN:"Length",TMCL:"Musician credits list",TMED:"Media type",TMOO:"Mood",TOAL:"Original album/movie/show title",TOFN:"Original filename",TOLY:"Original lyricist(s)/text writer(s)",TOPE:"Original artist(s)/performer(s)",TORY:"Original release year",TOWN:"File owner/licensee",TPE1:"Lead performer(s)/Soloist(s)",TPE2:"Band/orchestra/accompaniment",TPE3:"Conductor/performer refinement",TPE4:"Interpreted, remixed, or otherwise modified by",TPOS:"Part of a set",TPRO:"Produced notice",TPUB:"Publisher",TRCK:"Track number/Position in set",TRDA:"Recording dates",TRSN:"Internet radio station name",TRSO:"Internet radio station owner",TSOA:"Album sort order",TSOP:"Performer sort order",TSOT:"Title sort order",TSIZ:"Size",TSRC:"ISRC (international standard recording code)",TSSE:"Software/Hardware and settings used for encoding",TSST:"Set subtitle",TYER:"Year",TXXX:"User defined text information frame",UFID:"Unique file identifier",USER:"Terms of use",USLT:"Unsychronized lyric/text transcription",WCOM:"Commercial information",WCOP:"Copyright/Legal information",WOAF:"Official audio file webpage",WOAR:"Official artist/performer webpage",WOAS:"Official audio source webpage",WORS:"Official internet radio station homepage",WPAY:"Payment",WPUB:"Publishers official webpage",WXXX:"User defined URL link frame"};function e(){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function")}(function u(e,t,r){t&&n(e.prototype,t),r&&n(e,r)})(e,null,[{key:"getFrameReaderFunction",value:function(e){return e in c?c[e]:"T"===e[0]?c["T*"]:"W"===e[0]?c["W*"]:null}},{key:"readFrames",value:function(t,n,r,o,i){for(var a={},u=this._getFrameHeaderSize(o);t<n-u;){var s=this._readFrameHeader(r,t,o),c=s.id;if(!c)break;var f=s.flags,l=s.size,d=t+s.headerSize,g=r;if(t+=s.headerSize+s.size,!i||-1!==i.indexOf(c)){if("MP3e"===c||"\0MP3"===c||"\0\0MP"===c||" MP3"===c)break;f&&f.format.unsynchronisation&&!o.flags.unsynchronisation&&(g=this.getUnsyncFileReader(g,d,l),d=0,l=g.getSize()),f&&f.format.data_length_indicator&&(d+=4,l-=4),f=(s=e.getFrameReaderFunction(c))?s.apply(this,[d,l,g,f,o]):null,l={id:c,size:l,description:d=this._getFrameDescription(c),data:f},c in a?(a[c].id&&(a[c]=[a[c]]),a[c].push(l)):a[c]=l}}return a}},{key:"_getFrameHeaderSize",value:function(e){return 2==(e=e.major)?6:3==e||4==e?10:0}},{key:"_readFrameHeader",value:function(e,t,n){var r=n.major,o=null;switch(n=this._getFrameHeaderSize(n),r){case 2:var i=e.getStringAt(t,3),a=e.getInteger24At(t+3,!0);break;case 3:i=e.getStringAt(t,4),a=e.getLongAt(t+4,!0);break;case 4:i=e.getStringAt(t,4),a=e.getSynchsafeInteger32At(t+4)}return{id:(i=i!=String.fromCharCode(0,0,0)&&i!=String.fromCharCode(0,0,0,0)?i:"")||"",size:a||0,headerSize:n||0,flags:o=i&&2<r?this._readFrameFlags(e,t+8):o}}},{key:"_readFrameFlags",value:function(e,t){return{message:{tag_alter_preservation:e.isBitSetAt(t,6),file_alter_preservation:e.isBitSetAt(t,5),read_only:e.isBitSetAt(t,4)},format:{grouping_identity:e.isBitSetAt(t+1,7),compression:e.isBitSetAt(t+1,3),encryption:e.isBitSetAt(t+1,2),unsynchronisation:e.isBitSetAt(t+1,1),data_length_indicator:e.isBitSetAt(t+1,0)}}}},{key:"_getFrameDescription",value:function(e){return e in a?a[e]:"Unknown"}},{key:"getUnsyncFileReader",value:function(e,t,n){for(e=e.getBytesAt(t,n),t=0;t<e.length-1;t++)255===e[t]&&0===e[t+1]&&e.splice(t+1,1);return new i(e)}}]),t=e;var c={APIC:function(e,t,n,r,o){r=e;var i=v(n.getByteAt(e));switch(o&&o.major){case 2:o=n.getStringAt(e+1,3),e+=4;break;case 3:case 4:e+=1+(o=n.getStringWithCharsetAt(e+1,t-1)).bytesReadCount;break;default:throw Error("Couldn't read ID3v2 major version.")}var a=n.getByteAt(e),a=f[a];return e+=1+(i=n.getStringWithCharsetAt(e+1,t-(e-r)-1,i)).bytesReadCount,{format:o.toString(),type:a,description:i.toString(),data:n.getBytesAt(e,r+t-e)}},CHAP:function(e,t,n,r,o){r=e;var i={},a=s.readNullTerminatedString(n.getBytesAt(e,t));return i.id=a.toString(),e+=a.bytesReadCount,i.startTime=n.getLongAt(e,!0),i.endTime=n.getLongAt(e+=4,!0),i.startOffset=n.getLongAt(e+=4,!0),i.endOffset=n.getLongAt(e+=4,!0),i.subFrames=this.readFrames(e+=4,e+(t-(e-r)),n,o),i},CTOC:function(e,t,n,r,o){r=e;var i={childElementIds:[],id:void 0,topLevel:void 0,ordered:void 0,entryCount:void 0,subFrames:void 0},a=s.readNullTerminatedString(n.getBytesAt(e,t));for(i.id=a.toString(),e+=a.bytesReadCount,i.topLevel=n.isBitSetAt(e,1),i.ordered=n.isBitSetAt(e,0),i.entryCount=n.getByteAt(++e),e++,a=0;a<i.entryCount;a++){var u=s.readNullTerminatedString(n.getBytesAt(e,t-(e-r)));i.childElementIds.push(u.toString()),e+=u.bytesReadCount}return i.subFrames=this.readFrames(e,e+(t-(e-r)),n,o),i},COMM:function(e,t,n,r,o){var i=e,a=v(n.getByteAt(e));return r=n.getStringAt(e+1,3),e+=4+(o=n.getStringWithCharsetAt(e+4,t-4,a)).bytesReadCount,e=n.getStringWithCharsetAt(e,i+t-e,a),{language:r,short_description:o.toString(),text:e.toString()}}},f=(c.COM=c.COMM,c.PIC=function(e,t,n,r,o){return c.APIC(e,t,n,r,o)},c.PCNT=function(e,t,n,r,o){return n.getLongAt(e,!1)},c.CNT=c.PCNT,c["T*"]=function(e,t,n,r,o){return r=v(n.getByteAt(e)),n.getStringWithCharsetAt(e+1,t-1,r).toString()},c.TXXX=function(e,t,n,r,o){return r=v(n.getByteAt(e)),p(e,t,n,r)},c.WXXX=function(e,t,n,r,o){return 0===t?null:(r=v(n.getByteAt(e)),p(e,t,n,r))},c["W*"]=function(e,t,n,r,o){return 0===t?null:n.getStringWithCharsetAt(e,t,"iso-8859-1").toString()},c.TCON=function(e,t,n,r){return c["T*"].apply(this,arguments).replace(/^\(\d+\)/,"")},c.TCO=c.TCON,c.USLT=function(e,t,n,r,o){var i=e,a=v(n.getByteAt(e));return r=n.getStringAt(e+1,3),e+=4+(o=n.getStringWithCharsetAt(e+4,t-4,a)).bytesReadCount,e=n.getStringWithCharsetAt(e,i+t-e,a),{language:r,descriptor:o.toString(),lyrics:e.toString()}},c.ULT=c.USLT,c.UFID=function(e,t,n,r,o){return e+=(r=s.readNullTerminatedString(n.getBytesAt(e,t))).bytesReadCount,e=n.getBytesAt(e,t-r.bytesReadCount),{ownerIdentifier:r.toString(),identifier:e}},"Other;32x32 pixels 'file icon' (PNG only);Other file icon;Cover (front);Cover (back);Leaflet page;Media (e.g. label side of CD);Lead artist/lead performer/soloist;Artist/performer;Conductor;Band/Orchestra;Composer;Lyricist/text writer;Recording Location;During recording;During performance;Movie/video screen capture;A bright coloured fish;Illustration;Band/artist logotype;Publisher/Studio logotype".split(";"));r.exports=t},{"./ArrayFileReader":3,"./MediaFileReader":11,"./StringUtils":13}],9:[function(t,r,o){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function e(t,n){return(e=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(t,n)}function b(r){var o=function h(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=l(r);if(!(t=o?(e=l(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))||"object"!==n(t)&&"function"!=typeof t){if(void 0===this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");t=this}return t}}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}o=t("./MediaTagReader"),t("./MediaFileReader");var i,g=t("./ID3v2FrameReader");function a(){if(this instanceof a)return i.apply(this,arguments);throw new TypeError("Cannot call a class as a function")}(function p(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&e(t,n)})(a,o),i=b(a),function v(e,t,n){t&&u(e.prototype,t),n&&u(e,n)}(a,[{key:"_loadData",value:function(e,t){e.loadRange([6,9],{onSuccess:function(){e.loadRange([0,10+e.getSynchsafeInteger32At(6)-1],t)},onError:t.onError})}},{key:"_parseData",value:function(e,t){var n,r=0,o=e.getByteAt(r+3);if(4<o)return{type:"ID3",version:">2.4",tags:{}};var i,a,u,s=e.getByteAt(r+4),c=e.isBitSetAt(r+5,7),f=e.isBitSetAt(r+5,6),l=e.isBitSetAt(r+5,5),d=e.getSynchsafeInteger32At(r+6);for(a in r+=10,f&&(r+=4===o?i=e.getSynchsafeInteger32At(r):(i=e.getLongAt(r,!0))+4),i={type:"ID3",version:"2."+o+"."+s,major:o,revision:s,flags:{unsynchronisation:c,extended_header:f,experimental_indicator:l,footer_present:!1},size:d,tags:{}},t&&(n=this._expandShortcutTags(t)),t=d+10,i.flags.unsynchronisation&&(e=g.getUnsyncFileReader(e,r,d),r=0,t=e.getSize()),e=g.readFrames(r,t,e,i,n),y)y.hasOwnProperty(a)&&(n=this._getFrameData(e,y[a]))&&(i.tags[a]=n);for(u in e)e.hasOwnProperty(u)&&(i.tags[u]=e[u]);return i}},{key:"_getFrameData",value:function(e,t){for(var n,r=0;n=t[r];r++)if(n in e)return(e=e[n]instanceof Array?e[n][0]:e[n]).data}},{key:"getShortcuts",value:function(){return y}}],[{key:"getTagIdentifierByteRange",value:function(){return{offset:0,length:10}}},{key:"canReadTagFormat",value:function(e){return"ID3"===String.fromCharCode.apply(String,e.slice(0,3))}}]);var y={title:["TIT2","TT2"],artist:["TPE1","TP1"],album:["TALB","TAL"],year:["TYER","TYE"],comment:["COMM","COM"],track:["TRCK","TRK"],genre:["TCON","TCO"],picture:["APIC","PIC"],lyrics:["USLT","ULT"]};r.exports=t=a},{"./ID3v2FrameReader":8,"./MediaFileReader":11,"./MediaTagReader":12}],10:[function(t,r,o){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function e(t,n){return(e=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(t,n)}function b(r){var o=function h(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=l(r);if(!(t=o?(e=l(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))||"object"!==n(t)&&"function"!=typeof t){if(void 0===this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");t=this}return t}}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(){if(this instanceof c)return i.apply(this,arguments);throw new TypeError("Cannot call a class as a function")}o=t("./MediaTagReader"),t("./MediaFileReader"),function p(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&e(t,n)}(c,o),i=b(c),function v(e,t,n){t&&u(e.prototype,t),n&&u(e,n)}(c,[{key:"_loadData",value:function(e,t){var n=this;e.loadRange([0,16],{onSuccess:function(){n._loadAtom(e,0,"",t)},onError:t.onError})}},{key:"_loadAtom",value:function(e,t,n,r){var o,i,a,u;t>=e.getSize()||(o=this,0==(i=e.getLongAt(t,!0)))||isNaN(i)?r.onSuccess():(a=e.getStringAt(t+4,4),this._isContainerAtom(a)?("meta"==a&&(t+=4),"moov.udta.meta.ilst"==(u=(n?n+".":"")+a)?e.loadRange([t,t+i],r):e.loadRange([t+8,t+8+8],{onSuccess:function(){o._loadAtom(e,t+8,u,r)},onError:r.onError})):e.loadRange([t+i,t+i+8],{onSuccess:function(){o._loadAtom(e,t+i,n,r)},onError:r.onError}))}},{key:"_isContainerAtom",value:function(e){return 0<=["moov","udta","meta","ilst"].indexOf(e)}},{key:"_canReadAtom",value:function(e){return"----"!==e}},{key:"_parseData",value:function(e,t){var n,r={};for(n in t=this._expandShortcutTags(t),this._readAtom(r,e,0,e.getSize(),t),a)a.hasOwnProperty(n)&&(t=r[a[n]])&&(r[n]="track"===n?t.data.track:t.data);return{type:"MP4",ftyp:e.getStringAt(8,4),version:e.getLongAt(12,!0),tags:r}}},{key:"_readAtom",value:function(e,t,n,r,o,i,a){a=void 0===a?"":a+"  ";for(var u=n;u<n+r;){var s=t.getLongAt(u,!0);if(0==s)break;var c=t.getStringAt(u+4,4);if(this._isContainerAtom(c)){"meta"==c&&(u+=4),this._readAtom(e,t,u+8,s-8,o,(i?i+".":"")+c,a);break}(!o||0<=o.indexOf(c))&&"moov.udta.meta.ilst"===i&&this._canReadAtom(c)&&(e[c]=this._readMetadataAtom(t,u)),u+=s}}},{key:"_readMetadataAtom",value:function(e,t){var n=e.getLongAt(t,!0),r=e.getStringAt(t+4,4),o=e.getInteger24At(t+16+1,!0),o=s[o];if("trkn"==r)var i={track:e.getShortAt(t+16+10,!0),total:e.getShortAt(t+16+14,!0)};else if("disk"==r)i={disk:e.getShortAt(t+16+10,!0),total:e.getShortAt(t+16+14,!0)};else{t+=24;var a=n-24;switch(o="covr"===r&&"uint8"===o?"jpeg":o){case"text":i=e.getStringWithCharsetAt(t,a,"utf-8").toString();break;case"uint8":i=e.getShortAt(t,!1);break;case"int":case"uint":i=("int"==o?1==a?e.getSByteAt:2==a?e.getSShortAt:4==a?e.getSLongAt:e.getLongAt:1==a?e.getByteAt:2==a?e.getShortAt:e.getLongAt).call(e,t+(8==a?4:0),!0);break;case"jpeg":case"png":i={format:"image/"+o,data:e.getBytesAt(t,a)}}}return{id:r,size:n,description:f[r]||"Unknown",data:i}}},{key:"getShortcuts",value:function(){return a}}],[{key:"getTagIdentifierByteRange",value:function(){return{offset:0,length:16}}},{key:"canReadTagFormat",value:function(e){return"ftyp"===String.fromCharCode.apply(String,e.slice(4,8))}}]);var i,s={0:"uint8",1:"text",13:"jpeg",14:"png",21:"int",22:"uint"},f={"©alb":"Album","©ART":"Artist",aART:"Album Artist","©day":"Release Date","©nam":"Title","©gen":"Genre",gnre:"Genre",trkn:"Track Number","©wrt":"Composer","©too":"Encoding Tool","©enc":"Encoded By",cprt:"Copyright",covr:"Cover Art","©grp":"Grouping",keyw:"Keywords","©lyr":"Lyrics","©cmt":"Comment",tmpo:"Tempo",cpil:"Compilation",disk:"Disc Number",tvsh:"TV Show Name",tven:"TV Episode ID",tvsn:"TV Season",tves:"TV Episode",tvnn:"TV Network",desc:"Description",ldes:"Long Description",sonm:"Sort Name",soar:"Sort Artist",soaa:"Sort Album",soco:"Sort Composer",sosn:"Sort Show",purd:"Purchase Date",pcst:"Podcast",purl:"Podcast URL",catg:"Category",hdvd:"HD Video",stik:"Media Type",rtng:"Content Rating",pgap:"Gapless Playback",apID:"Purchase Account",sfID:"Country Code",atID:"Artist ID",cnID:"Catalog ID",plID:"Collection ID",geID:"Genre ID","xid ":"Vendor Information",flvr:"Codec Flavor"},a={title:"©nam",artist:"©ART",album:"©alb",year:"©day",comment:"©cmt",track:"trkn",genre:"©gen",picture:"covr",lyrics:"©lyr"};r.exports=t=c},{"./MediaFileReader":11,"./MediaTagReader":12}],11:[function(t,r,o){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function v(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}var i=t("./StringUtils");function e(t){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");v(this,"_isInitialized",void 0),v(this,"_size",void 0),this._isInitialized=!1,this._size=0}(function u(e,t,r){t&&n(e.prototype,t),r&&n(e,r)})(e,[{key:"init",value:function(e){var t=this;if(!this._isInitialized)return this._init({onSuccess:function(){t._isInitialized=!0,e.onSuccess()},onError:e.onError});setTimeout(e.onSuccess,1)}},{key:"_init",value:function(e){throw Error("Must implement init function")}},{key:"loadRange",value:function(e,t){throw Error("Must implement loadRange function")}},{key:"getSize",value:function(){if(this._isInitialized)return this._size;throw Error("init() must be called first.")}},{key:"getByteAt",value:function(e){throw Error("Must implement getByteAt function")}},{key:"getBytesAt",value:function(e,t){for(var n=Array(t),r=0;r<t;r++)n[r]=this.getByteAt(e+r);return n}},{key:"isBitSetAt",value:function(e,t){return 0!=(this.getByteAt(e)&1<<t)}},{key:"getSByteAt",value:function(e){return 127<(e=this.getByteAt(e))?e-256:e}},{key:"getShortAt",value:function(e,t){return(e=t?(this.getByteAt(e)<<8)+this.getByteAt(e+1):(this.getByteAt(e+1)<<8)+this.getByteAt(e))<0&&(e+=65536),e}},{key:"getSShortAt",value:function(e,t){return 32767<(e=this.getShortAt(e,t))?e-65536:e}},{key:"getLongAt",value:function(e,t){var n=this.getByteAt(e),r=this.getByteAt(e+1),o=this.getByteAt(e+2);return e=this.getByteAt(e+3),(t=t?(((n<<8)+r<<8)+o<<8)+e:(((e<<8)+o<<8)+r<<8)+n)<0&&(t+=4294967296),t}},{key:"getSLongAt",value:function(e,t){return 2147483647<(e=this.getLongAt(e,t))?e-4294967296:e}},{key:"getInteger24At",value:function(e,t){var n=this.getByteAt(e),r=this.getByteAt(e+1);return e=this.getByteAt(e+2),(t=t?((n<<8)+r<<8)+e:((e<<8)+r<<8)+n)<0&&(t+=16777216),t}},{key:"getStringAt",value:function(e,t){for(var n=[],r=e,o=0;r<e+t;r++,o++)n[o]=String.fromCharCode(this.getByteAt(r));return n.join("")}},{key:"getStringWithCharsetAt",value:function(e,t,n){switch(e=this.getBytesAt(e,t),(n||"").toLowerCase()){case"utf-16":case"utf-16le":case"utf-16be":n=i.readUTF16String(e,"utf-16be"===n);break;case"utf-8":n=i.readUTF8String(e);break;default:n=i.readNullTerminatedString(e)}return n}},{key:"getCharAt",value:function(e){return String.fromCharCode(this.getByteAt(e))}},{key:"getSynchsafeInteger32At",value:function(e){var t=this.getByteAt(e),n=this.getByteAt(e+1),r=this.getByteAt(e+2);return 127&this.getByteAt(e+3)|(127&r)<<7|(127&n)<<14|(127&t)<<21}}],[{key:"canReadFile",value:function(e){throw Error("Must implement canReadFile function")}}]),r.exports=t=e},{"./StringUtils":13}],12:[function(e,t,r){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function v(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}function d(e){if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");v(this,"_mediaFileReader",void 0),v(this,"_tags",void 0),this._mediaFileReader=e,this._tags=null}e("./MediaFileReader"),function u(e,t,r){t&&n(e.prototype,t),r&&n(e,r)}(d,[{key:"setTagsToRead",value:function(e){return this._tags=e,this}},{key:"read",value:function(t){var n=this;this._mediaFileReader.init({onSuccess:function(){n._loadData(n._mediaFileReader,{onSuccess:function(){try{var e=n._parseData(n._mediaFileReader,n._tags)}catch(e){if(t.onError)return void t.onError({type:"parseData",info:e.message})}t.onSuccess(e)},onError:t.onError})},onError:t.onError})}},{key:"getShortcuts",value:function(){return{}}},{key:"_loadData",value:function(e,t){throw Error("Must implement _loadData function")}},{key:"_parseData",value:function(e,t){throw Error("Must implement _parseData function")}},{key:"_expandShortcutTags",value:function(e){if(!e)return null;for(var t,n=[],r=this.getShortcuts(),o=0;t=e[o];o++)n=n.concat(r[t]||[t]);return n}}],[{key:"getTagIdentifierByteRange",value:function(){throw Error("Must implement")}},{key:"canReadTagFormat",value:function(e){throw Error("Must implement")}}]),t.exports=e=d},{"./MediaFileReader":11}],13:[function(t,r,o){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function v(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(function u(e,t,r){t&&n(e.prototype,t),r&&n(e,r)})(e,[{key:"toString",value:function(){return this._value}}]);var c=e;function e(t,n){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");v(this,"_value",void 0),v(this,"bytesReadCount",void 0),v(this,"length",void 0),this._value=t,this.bytesReadCount=n,this.length=t.length}r.exports={readUTF16String:function(e,t,n){var r=0,o=1,i=0;n=Math.min(n||e.length,e.length),254==e[0]&&255==e[1]?(t=!0,r=2):255==e[0]&&254==e[1]&&(t=!1,r=2),t&&(o=0,i=1),t=[];for(var a=0;r<n;a++){var u=e[r+o],s=(u<<8)+e[r+i];if(r+=2,0==s)break;u<216||224<=u?t[a]=String.fromCharCode(s):(u=(e[r+o]<<8)+e[r+i],r+=2,t[a]=String.fromCharCode(s,u))}return new c(t.join(""),r)},readUTF8String:function(e,t){var n=0;t=Math.min(t||e.length,e.length),239==e[0]&&187==e[1]&&191==e[2]&&(n=3);for(var r=[],o=0;n<t;o++){var i,a,u=e[n++];if(0==u)break;u<128?r[o]=String.fromCharCode(u):194<=u&&u<224?(i=e[n++],r[o]=String.fromCharCode(((31&u)<<6)+(63&i))):224<=u&&u<240?(i=e[n++],a=e[n++],r[o]=String.fromCharCode(((255&u)<<12)+((63&i)<<6)+(63&a))):240<=u&&u<245&&(a=((7&u)<<18)+((63&(i=e[n++]))<<12)+((63&(a=e[n++]))<<6)+(63&e[n++])-65536,r[o]=String.fromCharCode(55296+(a>>10),56320+(1023&a)))}return new c(r.join(""),n)},readNullTerminatedString:function(e,t){var n=[];t=t||e.length;for(var r=0;r<t;){var o=e[r++];if(0==o)break;n[r-1]=String.fromCharCode(o)}return new c(n.join(""),r)}}},{}],14:[function(r,o,i){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function e(t,n){return(e=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(t,n)}function b(o){var i=function l(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,r=t(o);return r=!(r=i?(e=t(this).constructor,Reflect.construct(r,arguments,e)):r.apply(this,arguments))||"object"!==n(r)&&"function"!=typeof r?h(this):r}}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function t(e){return(t=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}var a,s=r("./ChunkedFileData");function c(e){var t;if(this instanceof c)return m(h(t=a.call(this)),"_url",void 0),m(h(t),"_fileData",void 0),t._url=e,t._fileData=new s,t;throw new TypeError("Cannot call a class as a function")}(function p(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&e(t,n)})(c,r("./MediaFileReader")),a=b(c),function v(e,t,n){t&&u(e.prototype,t),n&&u(e,n)}(c,[{key:"_init",value:function(e){c._config.avoidHeadRequests?this._fetchSizeWithGetRequest(e):this._fetchSizeWithHeadRequest(e)}},{key:"_fetchSizeWithHeadRequest",value:function(t){var n=this;this._makeXHRRequest("HEAD",null,{onSuccess:function(e){(e=n._parseContentLength(e))?(n._size=e,t.onSuccess()):n._fetchSizeWithGetRequest(t)},onError:t.onError})}},{key:"_fetchSizeWithGetRequest",value:function(n){var r=this,e=this._roundRangeToChunkMultiple([0,0]);this._makeXHRRequest("GET",e,{onSuccess:function(e){var t=r._parseContentRange(e);if(e=r._getXhrResponseContent(e),t){if(null==t.instanceLength)return void r._fetchEntireFile(n);r._size=t.instanceLength}else r._size=e.length;r._fileData.addData(0,e),n.onSuccess()},onError:n.onError})}},{key:"_fetchEntireFile",value:function(t){var n=this;this._makeXHRRequest("GET",null,{onSuccess:function(e){e=n._getXhrResponseContent(e),n._size=e.length,n._fileData.addData(0,e),t.onSuccess()},onError:t.onError})}},{key:"_getXhrResponseContent",value:function(e){return e.responseBody||e.responseText||""}},{key:"_parseContentLength",value:function(e){return null==(e=this._getResponseHeader(e,"Content-Length"))?e:parseInt(e,10)}},{key:"_parseContentRange",value:function(e){if(e=this._getResponseHeader(e,"Content-Range")){var t=e.match(/bytes (\d+)-(\d+)\/(?:(\d+)|\*)/i);if(t)return{firstBytePosition:parseInt(t[1],10),lastBytePosition:parseInt(t[2],10),instanceLength:t[3]?parseInt(t[3],10):null};throw Error("FIXME: Unknown Content-Range syntax: "+e)}return null}},{key:"loadRange",value:function(t,n){var r=this;r._fileData.hasDataRange(t[0],Math.min(r._size,t[1]))?setTimeout(n.onSuccess,1):((t=this._roundRangeToChunkMultiple(t))[1]=Math.min(r._size,t[1]),this._makeXHRRequest("GET",t,{onSuccess:function(e){e=r._getXhrResponseContent(e),r._fileData.addData(t[0],e),n.onSuccess()},onError:n.onError}))}},{key:"_roundRangeToChunkMultiple",value:function(e){return[e[0],e[0]+1024*Math.ceil((e[1]-e[0]+1)/1024)-1]}},{key:"_makeXHRRequest",value:function(e,t,n){function hg(){200===r.status||206===r.status?n.onSuccess(r):n.onError&&n.onError({type:"xhr",info:"Unexpected HTTP status "+r.status+".",xhr:r}),r=null}var r=this._createXHRObject();r.open(e,this._url);void 0!==r.onload?(r.onload=hg,r.onerror=function(){n.onError&&n.onError({type:"xhr",info:"Generic XHR error, check xhr object.",xhr:r})}):r.onreadystatechange=function(){4===r.readyState&&hg()},c._config.timeoutInSec&&(r.timeout=1e3*c._config.timeoutInSec,r.ontimeout=function(){n.onError&&n.onError({type:"xhr",info:"Timeout after "+r.timeout/1e3+"s. Use jsmediatags.Config.setXhrTimeout to override.",xhr:r})}),r.overrideMimeType("text/plain; charset=x-user-defined"),t&&this._setRequestHeader(r,"Range","bytes="+t[0]+"-"+t[1]),this._setRequestHeader(r,"If-Modified-Since","Sat, 01 Jan 1970 00:00:00 GMT"),r.send(null)}},{key:"_setRequestHeader",value:function(e,t,n){c._config.disallowedXhrHeaders.indexOf(t.toLowerCase())<0&&e.setRequestHeader(t,n)}},{key:"_hasResponseHeader",value:function(e,t){if(!(e=e.getAllResponseHeaders()))return!1;e=e.split("\r\n");for(var n=[],r=0;r<e.length;r++)n[r]=e[r].split(":")[0].toLowerCase();return 0<=n.indexOf(t.toLowerCase())}},{key:"_getResponseHeader",value:function(e,t){return this._hasResponseHeader(e,t)?e.getResponseHeader(t):null}},{key:"getByteAt",value:function(e){return 255&this._fileData.getByteAt(e).charCodeAt(0)}},{key:"_isWebWorker",value:function(){return"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope}},{key:"_createXHRObject",value:function(){if("undefined"==typeof window&&!this._isWebWorker())return new(r("xhr2").XMLHttpRequest);if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;throw Error("XMLHttpRequest is not supported")}}],[{key:"canReadFile",value:function(e){return"string"==typeof e&&/^[a-z]+:\/\//i.test(e)}},{key:"setConfig",value:function(e){for(var t in e)e.hasOwnProperty(t)&&(this._config[t]=e[t]);for(e=this._config.disallowedXhrHeaders,t=0;t<e.length;t++)e[t]=e[t].toLowerCase()}}]),m(i=c,"_config",void 0),i._config={avoidHeadRequests:!1,disallowedXhrHeaders:[],timeoutInSec:30},o.exports=i},{"./ChunkedFileData":5,"./MediaFileReader":11,xhr2:2}],15:[function(t,r,o){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function v(e,t,n){t&&u(e.prototype,t),n&&u(e,n)}function p(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}function e(e,t){var n=e.offset<0&&(-e.offset>t||0<e.offset+e.length);return!(0<=e.offset&&e.offset+e.length>=t||n)}t("./MediaFileReader");var i=t("./XhrFileReader"),s=t("./BlobFileReader"),c=t("./ArrayFileReader"),f=(t("./MediaTagReader"),t("./ID3v1TagReader")),l=t("./ID3v2TagReader"),d=t("./MP4TagReader"),g=t("./FLACTagReader"),y=[],h=[],m=(v(a,[{key:"setTagsToRead",value:function(e){return this._tagsToRead=e,this}},{key:"setFileReader",value:function(e){return this._fileReader=e,this}},{key:"setTagReader",value:function(e){return this._tagReader=e,this}},{key:"read",value:function(t){var n=new(this._getFileReader())(this._file),r=this;n.init({onSuccess:function(){r._getTagReader(n,{onSuccess:function(e){new e(n).setTagsToRead(r._tagsToRead).read(t)},onError:t.onError})},onError:t.onError})}},{key:"_getFileReader",value:function(){return this._fileReader||this._findFileReader()}},{key:"_findFileReader",value:function(){for(var e=0;e<y.length;e++)if(y[e].canReadFile(this._file))return y[e];throw Error("No suitable file reader found for "+this._file)}},{key:"_getTagReader",value:function(e,t){var n;this._tagReader?(n=this._tagReader,setTimeout(function(){t.onSuccess(n)},1)):this._findTagReader(e,t)}},{key:"_findTagReader",value:function(o,i){for(var t=[],n=[],a=o.getSize(),r=0;r<h.length;r++){var u=h[r].getTagIdentifierByteRange();e(u,a)&&(0<=u.offset&&u.offset<a/2||u.offset<0&&u.offset<-a/2?t:n).push(h[r])}var s=!1,r={onSuccess:function(){if(s){for(var t=0;t<h.length;t++){var n=h[t].getTagIdentifierByteRange();if(e(n,a)){try{var r=o.getBytesAt(0<=n.offset?n.offset:n.offset+a,n.length)}catch(e){return void(i.onError&&i.onError({type:"fileReader",info:e.message}))}if(h[t].canReadTagFormat(r))return void i.onSuccess(h[t])}}i.onError&&i.onError({type:"tagFormat",info:"No suitable tag reader found"})}else s=!0},onError:i.onError};this._loadTagIdentifierRanges(o,t,r),this._loadTagIdentifierRanges(o,n,r)}},{key:"_loadTagIdentifierRanges",value:function(e,t,n){if(0===t.length)setTimeout(n.onSuccess,1);else{for(var r=[Number.MAX_VALUE,0],o=e.getSize(),i=0;i<t.length;i++){var a=0<=(u=t[i].getTagIdentifierByteRange()).offset?u.offset:u.offset+o,u=a+u.length-1;r[0]=Math.min(a,r[0]),r[1]=Math.max(u,r[1])}e.loadRange(r,n)}}}]),a);function a(e){n(this,a),p(this,"_file",void 0),p(this,"_tagsToRead",void 0),p(this,"_fileReader",void 0),p(this,"_tagReader",void 0),this._file=e}(o=(()=>{function a(){n(this,a)}return v(a,null,[{key:"addFileReader",value:function(e){return y.push(e),a}},{key:"addTagReader",value:function(e){return h.push(e),a}},{key:"removeTagReader",value:function(e){return 0<=(e=h.indexOf(e))&&h.splice(e,1),a}},{key:"EXPERIMENTAL_avoidHeadRequests",value:function(){i.setConfig({avoidHeadRequests:!0})}},{key:"setDisallowedXhrHeaders",value:function(e){i.setConfig({disallowedXhrHeaders:e})}},{key:"setXhrTimeoutInSec",value:function(e){i.setConfig({timeoutInSec:e})}}]),a})()).addFileReader(i).addFileReader(s).addFileReader(c).addTagReader(l).addTagReader(f).addTagReader(d).addTagReader(g),"undefined"==typeof process||process.browser||(t="undefined"!=typeof navigator&&"ReactNative"===navigator.product?t("./ReactNativeFileReader"):t("./NodeFileReader"),o.addFileReader(t)),r.exports={read:function(e,t){new m(e).read(t)},Reader:m,Config:o}},{"./ArrayFileReader":3,"./BlobFileReader":4,"./FLACTagReader":6,"./ID3v1TagReader":7,"./ID3v2TagReader":9,"./MP4TagReader":10,"./MediaFileReader":11,"./MediaTagReader":12,"./NodeFileReader":1,"./ReactNativeFileReader":1,"./XhrFileReader":14}]},{},[15])(15)});